<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lessons - Text-to-Speech</title>
    <link rel="stylesheet" href="../static/css/styles2.css">
</head>

<body>
    <div class="navbar">
        <ul>
            <div class="logo">
                <img src="../static/img/ublogo.png" alt="University Logo">
            </div>
            <li><a href="/">Home</a></li>
            <li><a href="/convert">Convert</a></li>
            <li><a href="/lesson">Lessons</a></li>
        </ul>
    </div>

    <div class="con-commands">
        <div class="commands">
            <div class="btn-read">
                <button id="readBtn"><ion-icon name="book"></ion-icon></button>
            </div>

            <div class="btn-pause">
                <button id="pauseBtn" disabled><ion-icon name="pause"></ion-icon></button>
            </div>

            <div class="btn-stop">
                <button id="stopBtn" disabled><ion-icon name="stop"></ion-icon></button>
            </div>

            <div class="btn-command">
                <button id="speech-command"><ion-icon name="mic"></ion-icon></button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="con-card">
        <h1>Chapter 1 - Labor Law</h1>

        <p id="para1" >
            Isang kahig, isang tuka...a meek characterization commonly tagged to most Filipino laborers, to portray the
            daily plight
            of an ordinary worker whose hands act as nothing more than a conduit of the money he earns, from his
            paycheck towards
            the overwhelming expenses that he and his family has to incur in order to withstand the survival-driven
            society that we
            are in. Therefore, he would most likely concern himself solely on receiving the monetary equivalent of the
            services that
            he has and will be rendering for another person. However, more than just wages and bonuses, his/her labor
            rights
            comprehend a wider array of benefits and remunerations than what is being extended to him/her - much less
            he/she is
            being made aware of.
        </p>

        <p id="para2">
            So the first question we have to address before we go wobbly with technical terms and legal jargons as
            regards
            employment rights and duties is: what is labor law? It is a law that governs the rights and duties of
            employers and
            employees, with respect to the following:
            1. terms and conditions of employment
            2. labor disputes arising from collective bargaining respecting such terms and conditions
        </p>

        <p id="para3">
            From the above-mentioned definition, two major divisions of Labor Law were formulated - the first one is
            Labor Standard
            laws, while the second is Labor Relations laws. The former deals primarily with the minimum standards of
            labor, such as
            wages, hours of work and other terms and conditions; the latter deals with how the employer-employee
            relations serves as
            the foundation for resorting to legal and peaceful means of resolving any dispute or disagreement arising
            from the terms
            and conditions of employment.
        </p>

        <!-- Dropdown for voice selection -->
        <label for="voiceSelect">Choose Voice:</label>
        <select id="voiceSelect"></select>
        

        <!-- Navigation -->
        <div class="navigation">
            <a href="/laborlaw1">1</a> |
            <a href="/laborlaw2">2</a> |
            <a href="/laborlaw3">3</a> |
            <a href="/laborlaw4">4</a> |
            <a href="/laborlaw5">5</a>
        </div>
    </div>
    </div>

    <script>
        let speechSynthesisUtterance;
        let voices = [];
        let isPaused = false;

        // Load available voices
        function loadVoices() {
            voices = window.speechSynthesis.getVoices();
            voices.forEach((voice, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = voice.name;
                document.getElementById('voiceSelect').appendChild(option);
            });
        }

        // Read text with speech synthesis
        function readText() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();  // Cancel any ongoing speech
            }

            let selectedVoiceIndex = document.getElementById('voiceSelect').value;
            let selectedVoice = voices[selectedVoiceIndex];
            let paragraphs = [document.getElementById('para1'), document.getElementById('para2'), document.getElementById('para3')];
            let textToRead = paragraphs.map(p => p.innerText).join(' ');

            speechSynthesisUtterance = new SpeechSynthesisUtterance(textToRead);
            speechSynthesisUtterance.voice = selectedVoice;

            speechSynthesisUtterance.onend = function () {
                document.getElementById('pauseBtn').disabled = true;
                document.getElementById('stopBtn').disabled = true;
                document.getElementById('readBtn').disabled = false;
            };

            speechSynthesis.speak(speechSynthesisUtterance);
            document.getElementById('readBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('stopBtn').disabled = false;
        }

        // Pause/Resume speech synthesis
        function togglePauseResume() {
            if (!isPaused) {
                speechSynthesis.pause();
                document.getElementById('pauseBtn').innerHTML = '<ion-icon name="play"></ion-icon>';
            } else {
                speechSynthesis.resume();
                document.getElementById('pauseBtn').innerHTML = '<ion-icon name="pause"></ion-icon>';
            }
            isPaused = !isPaused;
        }

        // Stop speech synthesis completely
        function stopSpeech() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            document.getElementById('readBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('pauseBtn').innerHTML = '<ion-icon name="play"></ion-icon>';
            isPaused = false;
        }

        // Stop speech synthesis when navigating away or refreshing
        window.addEventListener('beforeunload', function () {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
        });

        // Handle page load events
        document.addEventListener('DOMContentLoaded', function () {
            if (window.speechSynthesis) {
                window.speechSynthesis.onvoiceschanged = loadVoices;
            }
            document.getElementById('readBtn').addEventListener('click', readText);
            document.getElementById('pauseBtn').addEventListener('click', togglePauseResume);
            document.getElementById('stopBtn').addEventListener('click', stopSpeech);


    window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    let recognition;
    let recognizing = false;

    // Initialize speech recognition
    if (window.SpeechRecognition) {
    recognition = new SpeechRecognition();
    recognition.continuous = true;
    recognition.lang = 'en-US';

    // Toggle recognition on button click
    document.getElementById('speech-command').addEventListener('click', function () {
        if (recognizing) {
            recognition.stop();
            recognizing = false;
            this.innerHTML = '<ion-icon name="mic"></ion-icon>'; // Reset icon
        } else {
            recognition.start();
            recognizing = true;
            this.innerHTML = '<ion-icon name="mic-off"></ion-icon>'; // Change icon to indicate active listening
        }
    });

    // Handle recognized commands
    recognition.onresult = function (event) {
        const command = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();
        console.log("Recognized command:", command);

        // Function to speak a confirmation message and navigate afterward
        function speakConfirmation(message, action) {
            const confirmationMessage = new SpeechSynthesisUtterance(message);
            confirmationMessage.onend = action; // Run action after confirmation is spoken
            window.speechSynthesis.speak(confirmationMessage);
        }

        // Execute actions based on recognized commands
        if (command.includes("next page")) {
            speakConfirmation("Okay Master, Navigating to the next page.", () => window.location.href = '/laborlaw2'); // Adjust to your next page URL
        } else if (command.includes("previous page")) {
            speakConfirmation("Okay Master, Going to the previous page.", () => window.history.back());
        } else if (command.includes("go to home")) {
            speakConfirmation("Returning to home page Master.", () => window.location.href = '/');
        } else if (command.includes("stop")) {
            speakConfirmation("Stopping the audio Master.", () => document.getElementById('stopBtn').click());
        } else if (command.includes("pause")) {
            speakConfirmation("Pausing the audio Master.", () => document.getElementById('pauseBtn').click());
        } else if (command.includes("read")) {
            speakConfirmation("Reading aloud.", () => document.getElementById('readBtn').click());
        }
    };

    recognition.onerror = function (event) {
        console.error("Speech recognition error:", event.error);
        recognizing = false;
        document.getElementById('speech-command').innerHTML = '<ion-icon name="logo-soundcloud"></ion-icon>';
        };
    } 

    else {
        alert("Your browser does not support Speech Recognition.");
    }
});
    </script>


    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</body>

</html>
